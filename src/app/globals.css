@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 220 40% 5%;
    --foreground: 210 40% 98%;
    --card: 220 40% 10%;
    --card-foreground: 210 40% 98%;
    --popover: 220 40% 5%;
    --popover-foreground: 210 40% 98%;
    --primary: 195 90% 60%;
    --primary-foreground: 210 40% 10%;
    --secondary: 210 40% 15%;
    --secondary-foreground: 210 40% 98%;
    --muted: 210 40% 15%;
    --muted-foreground: 210 40% 60%;
    --accent: 45 90% 60%;
    --accent-foreground: 210 40% 10%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 98%;
    --border: 210 40% 25%;
    --input: 210 40% 20%;
    --ring: 195 90% 65%;
    --chart-1: 195 100% 70%;
    --chart-2: 43 74% 49%;
    --chart-3: 280 60% 70%;
    --chart-4: 45 93% 47%;
    --chart-5: 340 75% 55%;
    --radius: 0.75rem;
  }

  .dark {
    --background: 220 40% 5%;
    --foreground: 210 40% 98%;
    --card: 220 40% 10%;
    --card-foreground: 210 40% 98%;
    --popover: 220 40% 5%;
    --popover-foreground: 210 40% 98%;
    --primary: 195 90% 60%;
    --primary-foreground: 210 40% 10%;
    --secondary: 210 40% 15%;
    --secondary-foreground: 210 40% 98%;
    --muted: 210 40% 15%;
    --muted-foreground: 210 40% 60%;
    --accent: 45 90% 60%;
    --accent-foreground: 210 40% 10%;
    --destructive: 0 62% 30%;
    --destructive-foreground: 0 0% 95%;
    --border: 210 40% 25%;
    --input: 210 40% 20%;
    --ring: 195 90% 65%;
    --chart-1: 195 100% 70%;
    --chart-2: 43 74% 49%;
    --chart-3: 280 60% 70%;
    --chart-4: 45 93% 47%;
    --chart-5: 340 75% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* iOS Safari 表单控件兼容性修复 */
/* 统一所有表单控件的外观，解决iOS上的宽度不一致问题 */
input[type="date"],
input[type="time"],
input[type="text"],
select {
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
  width: 100% !important;
  height: 3rem !important; /* 对应 Tailwind 的 h-12 */
  line-height: 3rem !important;
  box-sizing: border-box;
  padding-left: 0.75rem;
  padding-right: 0.75rem;
  background-position: right 0.75rem center;
  background-repeat: no-repeat;
}

/* 移除 iOS 自带的日历和时钟图标 */
input[type="date"]::-webkit-calendar-picker-indicator,
input[type="time"]::-webkit-calendar-picker-indicator {
  opacity: 0;
  display: none;
  pointer-events: none;
}

/* 确保 SelectTrigger 组件在 iOS 上也是一致的高度 */
[data-radix-select-trigger] {
  height: 3rem !important;
  line-height: 3rem !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
}

/* 移除 iOS Safari 的默认阴影和边框 */
input[type="date"]:focus,
input[type="time"]:focus,
input[type="text"]:focus,
select:focus {
  -webkit-appearance: none !important;
  outline: none !important;
}

/* iOS Safari 特殊修复：移除原生控件的圆角和阴影，但保留Tailwind样式 */
input[type="date"],
input[type="time"] {
  border-radius: 0.375rem !important; /* 对应 Tailwind 的 rounded-md */
  /* 强制添加focus样式，因为iOS的原生样式会覆盖Tailwind的focus效果 */
}

/* 统一所有输入框的基础样式 - 确保四个字段完全一致 */
input[type="date"],
input[type="time"],
input[type="text"],
[data-radix-select-trigger] {
  border-width: 1px !important;
  border-style: solid !important;
  transition: all 0.2s ease-in-out !important;
}

/* 统一所有输入框的focus样式 - 移除自定义box-shadow，让Tailwind的focus:ring-cyan-400正常工作 */
input[type="date"]:focus,
input[type="time"]:focus,
input[type="text"]:focus,
[data-radix-select-trigger]:focus,
input[type="date"]:focus-visible,
input[type="time"]:focus-visible,
input[type="text"]:focus-visible,
[data-radix-select-trigger]:focus-visible {
  border-color: hsl(var(--cyan-300)) !important;
  outline: none !important;
  -webkit-outline: none !important;
}

/* 确保性别选择器在打开状态时也有相同的边框颜色 */
[data-radix-select-trigger][data-state="open"] {
  border-color: hsl(var(--cyan-300)) !important;
  outline: none !important;
}

/* 移除浏览器默认的focus效果，强制使用我们的自定义样式 */
input[type="date"]:focus,
input[type="time"]:focus,
input[type="text"]:focus {
  outline: none !important;
  -webkit-outline: none !important;
  -webkit-tap-highlight-color: transparent !important;
}

/* 确保在 iOS 上所有输入框都有相同的内边距，但不覆盖focus效果 */
input[type="date"],
input[type="time"],
input[type="text"] {
  padding: 0.75rem !important;
  font-size: 1rem !important;
  line-height: 1.5rem !important;
}

/* 常清阁命理报告专用样式 */
/* 中文段落格式优化 */
.fortune-content {
  line-height: 1.6;
  paragraph-spacing: 0.5rem;
}

.fortune-content p {
  text-indent: 2em; /* 首行缩进两格 */
  margin: 0.3rem 0; /* 减少段落间距 */
  line-height: 1.6;
}

/* 文言开示专用格式 */
.classical-reading p {
  text-indent: 2em;
  margin: 0.2rem 0;
  line-height: 1.5;
  font-family: 'Noto Serif SC', serif;
  letter-spacing: 0.05em;
}

/* 白话解心专用格式 */
.vernacular-reading p {
  text-indent: 2em;
  margin: 0.4rem 0;
  line-height: 1.7;
  font-family: 'Noto Serif SC', serif;
}

/* 师者评语专用格式 */
.teacher-comment {
  margin: 0.5rem 0;
  line-height: 1.5;
  color: rgb(251 191 36 / 0.9); /* amber-400/90 */
  font-style: italic;
  border-left: 2px solid rgb(251 191 36 / 0.5); /* amber-400/50 */
  padding-left: 1rem;
  padding-top: 0.2rem;
  padding-bottom: 0.2rem;
  margin-left: 0.5rem;
  background: linear-gradient(90deg, rgba(251 191 36 / 0.1) 0%, transparent 100%);
  border-radius: 0.25rem;
}

/* 灯笼符号样式 */
.teacher-comment::before {
  display: inline-block;
  margin-right: 0.5rem;
  font-size: 1.1em;
  animation: flicker 3s ease-in-out infinite;
}

/* 灯笼微微闪烁效果 */
@keyframes flicker {
  0%, 100% { opacity: 1; filter: brightness(1); }
  50% { opacity: 0.8; filter: brightness(1.1); }
}

/* 章节标题优化 */
.section-title {
  margin-bottom: 1rem;
  margin-top: 1.5rem;
  font-weight: 600;
}

/* 内容容器优化 */
.content-section {
  margin-bottom: 2rem;
  padding: 0.5rem 0;
}

/* 移除空白的换行 */
.fortune-content br {
  display: none;
}

/* 确保段落间距一致 */
.fortune-content p + p {
  margin-top: 0.3rem;
}

.classical-reading p + p {
  margin-top: 0.2rem;
}

.vernacular-reading p + p {
  margin-top: 0.4rem;
}

/* 紧凑格式优化 - 减少板块间距 */
.section-item {
  margin-bottom: 0.8rem !important;
  padding: 0.3rem 0 !important;
}

.section-content {
  margin-bottom: 0.5rem !important;
  padding: 0.2rem 0 !important;
}

/* 进一步减少段落间距 */
.section-content p {
  margin-bottom: 0.2rem !important;
  line-height: 1.4 !important;
}

/* 师者评语紧凑化 */
.teacher-comment {
  margin: 0.3rem 0 !important;
  padding: 0.2rem 0.8rem !important;
}

/* 标题紧凑化 */
.section-title {
  margin-bottom: 0.6rem !important;
  margin-top: 1rem !important;
}

/* 移除不必要的空白 */
.content-section {
  margin-bottom: 1rem !important;
}
